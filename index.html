<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="../packages/hope/dist/hope.global.js"></script>
</head>

<body>
    <div id="app"></div>
    <script>
        const {
            reactive,
            effect,
            div,
            $div,
            span,
            $span,
            content,
            mount,
            hAttr,
            hProp,
            hOn,
            hClass,
            hStyle,
            hId,
            hShow,
            hText,
            hComment,
            block,
            defineComponent,
            onMounted,
            onUnmounted,
            onUpdated,
            s,
            media,
            keyframes,
            onElementUnmounted
        } = Hope;


        const state = reactive({
            test: 0,
            toggle: true,
            text: 1,
            className: 'title',
            id: 0,
            color: 'red',
            show: true,
            comment: '123',
            list: Array(3).fill(null),
            zIndex: 0
        })

        const [com, $com] = defineComponent(({
            props
        }) => {
            s('.name', {
                width: '100px',
                height: '100px',
                flex: '1',
                backgroundColor: () => state.color
            })

            media('(max-width: 3000px)', () => {
                // s('.name', {
                //   backgroundColor: 'blue'
                // })
                media('(min-width: 300px)', () => {
                    s('.name', {
                        backgroundColor: () => 'blue'
                    })
                })
            })

            // keyframes(() => {
            //   s('from', {
            //     width: '100px',
            //     color: 'red'
            //   })

            //   s('to', {
            //     width: '200px'
            //   })
            // })

            div()
            hClass('name')
            hText('hello, world!')
            $div()
        })

        const app = defineComponent(({
            props,
            slots,
            emit
        }) => {
            // onMounted(() => {})
            // onUnmounted(() => {})
            // onUpdated(() => {})

            // // emit()

            // // const 替换样式的正则表达式 = /\s*{/g
            // // style(() => `
            // //   .class {
            // //     background-color: red;
            // //   }

            // //   #id {

            // //   }
            // // `)

            // div()
            //   // component()
            //   //   hSlot('name', () => {})
            //   // $component()
            //   hAttr('class', () => state.className);
            //   hId(() => state.id)
            //   hText(() => state.text)
            //   hComment(() => state.comment)
            //   slots.default && slots.default()
            //   span()
            //     hShow(() => props.show)
            //     hClass(() => ({
            //       abc: state.id
            //     }))
            //     hOn('click', () => state.text++);
            //     hAttr('id', () => state.id)
            //     hStyle(() => ({
            //       display: 'block',
            //       width: '100px',
            //       height: '100px',
            //       backgroundColor: state.color
            //     }))
            //   $span()
            //   block(() => {
            //     state.list.forEach(v => {
            //       div()
            //         hText(() => state.text)
            //       $div()
            //     })
            //   })
            //   helloWorld()
            //     hProp('text', () => state.text)
            //   $helloWorld()
            // $div()

            // block(() => {
            //   div()
            //     hText(() => 1)
            //     block(() => {
            //       div()
            //         if (state.toggle) {
            //           div()
            //             hText(() => 1)
            //             block(() => {
            //               div()
            //                 hText(() => 1)
            //               $div()
            //             })
            //             com()
            //             $com()
            //           $div()
            //         } else {
            //           com()
            //           $com()
            //           div()
            //             hText(() => 2)
            //             block(() => {
            //               div()
            //                 hText(() => 2)
            //               $div()
            //             })
            //           $div()
            //         }
            //       $div()
            //     })
            //   $div()
            //   div()
            //     hText(() => 2)
            //     block(() => {
            //       div()
            //         if (state.toggle) {
            //           div()
            //             hText(() => 1)
            //             block(() => {
            //               div()
            //                 hText(() => 1)
            //                 com()
            //                 $com()
            //               $div()
            //             })
            //           $div()
            //         } else {
            //           div()
            //             hText(() => 2)
            //             block(() => {
            //               div()
            //                 hText(() => 2)
            //               $div()
            //               com()
            //               $com()
            //             })
            //           $div()
            //         }
            //       $div()
            //     })
            //   $div()
            // })

            // block(() => {
            //   div()
            //   $div()
            //   com()
            //     hProp('a', () => 'b')
            //   $com()
            // })
        })

        // setInterval(() => {
        //   state.toggle = !state.toggle;
        // })

        // const appProps = app.mount({
        //   target: document.body,
        //   props: {
        //     show: true
        //   }
        // })

        // try {
        //   div()
        //     hText(() => {throw new Error()})
        //   div()
        // } catch(err) {
        //   console.log(err)
        // }

        // mount(document.body);

        start()

        block(() => {
            div();
            com()
            hText('abc', 'a')
            $com()
            block(() => {
                if (state.show) {
                    state.list.forEach(v => {
                        com()
                        $com()
                    })
                }
            })
            $div();
        });

        // div()
        // block(() => {
        //   if (state.show) {
        //     span()
        //     hText('123')
        //     hAttr({ class: () => 'name' })
        //     onElementUnmounted(() => {
        //       console.log('el unmounted')
        //     })
        //     $span()
        //   }
        // })
        // $div()
        mount(document.body);

        setTimeout(end)
        // setInterval(() => {
        //   state.color = state.color === 'red' ? 'blue' : 'red';
        // })
        // setInterval(() => {
        //   state.show = !state.show
        // })

        function start() {
            time = performance.now()
        }

        function end() {
            console.log(performance.now() - time)
        }
    </script>
</body>

</html>